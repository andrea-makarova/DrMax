<!doctype html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Menu</title>
  <style>
    :root {
      --gray-50: #f2f2f7;
      --gray-100: #e5e5ea;
      --gray-300: #c7c7cc;
      --gray-400: #8e8e93;
      --gray-700: #3a3a3c;
      --gray-900: #1b1b1b;
      --green-500: #47850a;
      --red-500: #e4002b;
      --tabbar-height: 72px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--gray-50);
      font-family: "Proxima Vara", "Proxima Nova", "Figtree", system-ui, -apple-system, sans-serif;
      color: var(--gray-900);
    }
    .page {
      min-height: 100vh;
      padding: 0 16px 140px;
    }
    .topbar {
      position: sticky;
      top: 0;
      z-index: 5;
      height: 54px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 700;
      color: var(--gray-700);
      border-bottom: 1px solid var(--gray-100);
      background: #ffffff;
    }
    .topbar .back {
      position: absolute;
      left: 14px;
      width: 36px;
      height: 36px;
      border-radius: 999px;
      border: none;
      background: transparent;
      display: grid;
      place-items: center;
      cursor: pointer;
      color: var(--gray-700);
    }
    .topbar .back svg {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      stroke-width: 2.4;
      fill: none;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .profile {
      margin: 22px 0 16px;
      text-align: center;
    }
    .avatar {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: #dce8d0;
      display: grid;
      place-items: center;
      margin: 0 auto 14px;
    }
    .avatar svg {
      width: 40px;
      height: 40px;
      color: #78be20;
    }
    .name {
      font-size: 26px;
      font-weight: 700;
      margin: 0 0 4px;
      color: #2c2c2e;
    }
    .email {
      font-size: 16px;
      color: var(--gray-400);
      margin: 0;
    }
    .card {
      background: #ffffff;
      border-radius: 14px;
      border: 1px solid var(--gray-100);
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.04);
      margin: 14px 0;
    }
    .row {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      border-bottom: 1px solid var(--gray-100);
      color: var(--gray-700);
    }
    .row:last-child { border-bottom: none; }
    .row svg {
      width: 22px;
      height: 22px;
      color: var(--gray-700);
      flex-shrink: 0;
    }
    .row .row-icon {
      width: 22px;
      height: 22px;
      flex-shrink: 0;
      display: block;
    }
    .row-text {
      flex: 1;
      font-size: 16px;
      font-weight: 600;
    }
    .row-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--red-500);
      display: inline-block;
      margin-right: 6px;
      align-self: center;
      flex-shrink: 0;
    }
    .row-badge {
      font-size: 14px;
      color: var(--gray-400);
      margin-right: 6px;
    }
    .chev {
      color: var(--gray-300);
      font-size: 22px;
    }
    .row.logout {
      color: var(--red-500);
    }
    .row.logout svg {
      color: var(--red-500);
    }
    .loyalty {
      position: fixed;
      left: 16px;
      right: 16px;
      bottom: calc(var(--tabbar-height) + 16px);
      display: flex;
      justify-content: center;
      margin: 0;
      z-index: 10;
    }
    .loyalty button {
      background: #47850a;
      color: #ffffff;
      border: 1px solid #47850a;
      border-radius: 999px;
      padding: 12px 20px;
      font-size: 15px;
      font-weight: 700;
      line-height: 18px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 8px 18px rgba(53,107,9,0.25);
      cursor: pointer;
      pointer-events: auto;
    }
    .loyalty button:active { transform: translateY(1px); }
    .loyalty img {
      height: 18px;
      width: auto;
    }
    .tabbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #ffffff;
      border-top: 1px solid var(--gray-100);
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      padding: 16px 8px;
      height: var(--tabbar-height);
      box-shadow: 0 -10px 24px rgba(0, 0, 0, 0.05);
      z-index: 10;
    }
    .tab {
      display: grid;
      place-items: center;
      gap: 2px;
      font-size: 12px;
      color: var(--gray-400);
      text-decoration: none;
    }
    .tab-icon {
      width: 26px;
      height: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .tab-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
      filter: grayscale(1) brightness(0.8);
    }
    .tab.active { color: var(--green-500); font-weight: 700; }
    .tab.active .tab-icon img { filter: none; }
    .press-menu-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 18, 24, 0.4);
      display: none;
      align-items: flex-end;
      justify-content: center;
      z-index: 9999;
    }
    .press-menu-overlay.open { display: flex; }
    .press-menu {
      width: min(420px, calc(100% - 32px));
      background: #ffffff;
      border-radius: 20px 20px 16px 16px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 18px 30px rgba(15, 18, 24, 0.2);
      font-family: "Proxima Vara", "Proxima Nova", sans-serif;
    }
    .press-menu-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
      color: #3a3a3c;
      font-weight: 700;
      font-size: 15px;
    }
    .press-menu-close {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: #f0f1f4;
      color: #3a3a3c;
      font-size: 18px;
      cursor: pointer;
    }
    .press-menu-btn {
      width: 100%;
      border: none;
      border-radius: 999px;
      padding: 12px 16px;
      margin-top: 10px;
      background: #f7f7fb;
      color: #2c2c2e;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }
    .press-menu-btn.primary {
      background: #47850a;
      color: #ffffff;
    }
    .press-menu-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 10px;
      padding: 8px 4px;
      font-size: 14px;
      font-weight: 600;
      color: #2c2c2e;
    }
    .press-menu-switch {
      position: relative;
      width: 44px;
      height: 24px;
      display: inline-flex;
      align-items: center;
    }
    .press-menu-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .press-menu-slider {
      position: absolute;
      inset: 0;
      background: #d6d8de;
      border-radius: 999px;
      transition: background 0.2s ease;
    }
    .press-menu-slider::after {
      content: "";
      position: absolute;
      width: 18px;
      height: 18px;
      left: 3px;
      top: 3px;
      border-radius: 50%;
      background: #ffffff;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.16);
      transition: transform 0.2s ease;
    }
    .press-menu-switch input:checked + .press-menu-slider {
      background: #47850a;
    }
    .press-menu-switch input:checked + .press-menu-slider::after {
      transform: translateX(20px);
    }
  </style>
</head>
<body>
  <div class="topbar">
    <button class="back" type="button" onclick="window.location.href='app-home.html'" aria-label="Zpět">
      <svg viewBox="0 0 24 24">
        <path d="M15 6l-6 6 6 6"></path>
      </svg>
    </button>
    Menu
  </div>
  <main class="page">
    <section class="profile">
      <div class="avatar" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="8" r="4.5" fill="currentColor"></circle>
          <path d="M4 20c2.5-4 6-6 8-6s5.5 2 8 6" fill="currentColor"></path>
        </svg>
      </div>
      <h1 class="name">Magdaléna Procházková</h1>
      <p class="email">magda.prochazkova@hotmail.com</p>
    </section>

    <section class="card">
      <a class="row" href="healthy-movement.html" id="healthy-movement-link" style="text-decoration:none;">
        <img class="row-icon" src="images/MaxHealth.svg" alt="">
        <span class="row-text">Zdravý pohyb s Maxem</span>
        <span class="row-dot" aria-hidden="true"></span>
        <span class="chev">›</span>
      </a>
    </section>

    <section class="card">
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <path d="M7 3h10v18l-5-3-5 3V3z"></path>
        </svg>
        <span class="row-text">Nákupy</span>
        <span class="chev">›</span>
      </div>
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <path d="M12 20s-7-4.4-7-9a4 4 0 0 1 7-2 4 4 0 0 1 7 2c0 4.6-7 9-7 9z"></path>
        </svg>
        <span class="row-text">Moje oblíbené</span>
        <span class="row-badge">3</span>
        <span class="chev">›</span>
      </div>
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <rect x="3" y="5" width="18" height="14" rx="2"></rect>
          <circle cx="9" cy="12" r="2"></circle>
          <path d="M13 9h5M13 13h5"></path>
        </svg>
        <span class="row-text">Můj profil</span>
        <span class="chev">›</span>
      </div>
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <path d="M3 7h13v8H3z"></path>
          <path d="M16 10h3l2 3v2h-5z"></path>
          <circle cx="7" cy="17" r="1.5"></circle>
          <circle cx="17" cy="17" r="1.5"></circle>
        </svg>
        <span class="row-text">Doprava a platby</span>
        <span class="chev">›</span>
      </div>
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <path d="M12 3l8 4v4c0 5-3.5 8-8 10-4.5-2-8-5-8-10V7l8-4z"></path>
          <path d="M12 8v4"></path>
          <circle cx="12" cy="15.5" r="1"></circle>
        </svg>
        <span class="row-text">Přihlášení a zabezpečení</span>
        <span class="chev">›</span>
      </div>
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <rect x="3" y="6" width="18" height="12" rx="2"></rect>
          <path d="M3 9l9 6 9-6"></path>
        </svg>
        <span class="row-text">Marketingová komunikace</span>
        <span class="chev">›</span>
      </div>
    </section>

    <section class="card">
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <path d="M4 7h7v10H4z"></path>
          <path d="M11 12h9"></path>
          <path d="M19 9v6"></path>
        </svg>
        <span class="row-text">Najít lékárnu</span>
        <span class="chev">›</span>
      </div>
    </section>

    <section class="card">
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <path d="M3 6h18"></path>
          <path d="M3 12h18"></path>
          <path d="M3 18h18"></path>
          <circle cx="7" cy="6" r="2"></circle>
          <circle cx="17" cy="12" r="2"></circle>
          <circle cx="9" cy="18" r="2"></circle>
        </svg>
        <span class="row-text">Nastavení</span>
        <span class="chev">›</span>
      </div>
      <div class="row">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <circle cx="12" cy="12" r="9"></circle>
          <path d="M12 8v4"></path>
          <circle cx="12" cy="16" r="1"></circle>
        </svg>
        <span class="row-text">O aplikaci Dr. Max</span>
        <span class="chev">›</span>
      </div>
    </section>

    <section class="card">
      <div class="row logout">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
          <path d="M10 6H6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h4"></path>
          <path d="M15 12H8"></path>
          <path d="M15 12l-3-3"></path>
          <path d="M15 12l-3 3"></path>
        </svg>
        <span class="row-text">Odhlásit se</span>
      </div>
    </section>

    <div class="loyalty">
      <button type="button">
        <img src="images/Loyality Card.svg" alt="">
        věrnostní karta
      </button>
    </div>
  </main>

  <nav class="tabbar">
    <a class="tab" href="app-home.html">
      <div class="tab-icon"><img src="images/Home.svg" alt=""></div>
      <span>E-shop</span>
    </a>
    <a class="tab" href="#">
      <div class="tab-icon"><img src="images/Rx.svg" alt=""></div>
      <span>Recepty</span>
    </a>
    <a class="tab" href="#">
      <div class="tab-icon"><img src="images/Cart.svg" alt=""></div>
      <span>Košík</span>
    </a>
    <a class="tab" href="#">
      <div class="tab-icon"><img src="images/Purchases.svg" alt=""></div>
      <span>Nákupy</span>
    </a>
    <a class="tab active" href="menu.html">
      <div class="tab-icon"><img src="images/Menu.svg" alt=""></div>
      <span>Menu</span>
    </a>
  </nav>
  <div id="press-menu" class="press-menu-overlay" aria-hidden="true">
    <div class="press-menu" role="dialog" aria-modal="true" aria-label="Rychlé akce">
      <div class="press-menu-header">
        <span>Rychlé akce</span>
        <button class="press-menu-close" type="button" data-action="close">×</button>
      </div>
      <div class="press-menu-row">
        <span>Oprávnění</span>
        <label class="press-menu-switch">
          <input type="checkbox" id="press-permissions-toggle">
          <span class="press-menu-slider"></span>
        </label>
      </div>
      <button class="press-menu-btn" type="button" data-action="generate">Vygenerovat 3 razítka</button>
      <button class="press-menu-btn" type="button" data-action="reset">Resetovat prototyp</button>
      <button class="press-menu-btn primary" type="button" data-action="lockscreen">Uzamčená obrazovka</button>
    </div>
  </div>
  <script>
    if (localStorage.getItem('permissionsGranted') === 'true') {
      document.querySelector('.row-dot')?.remove();
    }
    document.getElementById('healthy-movement-link')?.addEventListener('click', (event) => {
      event.preventDefault();
      if (localStorage.getItem('healthyMovementCompleted') === 'true') {
        localStorage.setItem('suppressDrawersOnIndex', 'true');
        window.location.href = 'index.html';
        return;
      }
      window.location.href = 'healthy-movement.html';
    });
    (() => {
      const overlay = document.getElementById('press-menu');
      const menu = overlay?.querySelector('.press-menu');
      const permissionsToggle = document.getElementById('press-permissions-toggle');
      if (!overlay || !menu) return;
      let pressTimer = null;
      let startX = 0;
      let startY = 0;

      const openMenu = () => {
        overlay.classList.add('open');
        overlay.setAttribute('aria-hidden', 'false');
        if (permissionsToggle) {
          permissionsToggle.checked = localStorage.getItem('permissionsGranted') === 'true';
        }
      };
      const closeMenu = () => {
        overlay.classList.remove('open');
        overlay.setAttribute('aria-hidden', 'true');
      };
      const clearPressTimer = () => {
        if (pressTimer) {
          clearTimeout(pressTimer);
          pressTimer = null;
        }
      };
      const shouldIgnore = (target) => target.closest('button, a, input, textarea, select, .press-menu');

      document.addEventListener('touchstart', (event) => {
        if (shouldIgnore(event.target)) return;
        if (event.touches.length !== 2) {
          clearPressTimer();
          return;
        }
        const [t1, t2] = event.touches;
        startX = (t1.clientX + t2.clientX) / 2;
        startY = (t1.clientY + t2.clientY) / 2;
        clearPressTimer();
        pressTimer = setTimeout(() => openMenu(), 3000);
      }, { passive: true });
      document.addEventListener('touchmove', (event) => {
        if (!pressTimer) return;
        if (event.touches.length !== 2) {
          clearPressTimer();
          return;
        }
        const [t1, t2] = event.touches;
        const x = (t1.clientX + t2.clientX) / 2;
        const y = (t1.clientY + t2.clientY) / 2;
        const dx = Math.abs(x - startX);
        const dy = Math.abs(y - startY);
        if (dx > 12 || dy > 12) {
          clearPressTimer();
        }
      }, { passive: true });
      document.addEventListener('touchend', clearPressTimer);
      document.addEventListener('touchcancel', clearPressTimer);
      overlay.addEventListener('click', (event) => {
        if (event.target === overlay) closeMenu();
      });
      overlay.querySelectorAll('[data-action]').forEach((btn) => {
        btn.addEventListener('click', () => {
          const action = btn.dataset.action;
          closeMenu();
          if (action === 'close') return;
          if (action === 'reset') {
            localStorage.clear();
            localStorage.setItem('bonusRewardStage', 'first');
            localStorage.setItem('bonusRewardTitle', 'Bonus Reward');
            localStorage.setItem('bonusRewardText', '10% off Dr. Max products.');
            window.location.href = 'app-home.html';
            return;
          }
          if (action === 'lockscreen') {
            window.location.href = 'lockscreen-notification.html';
            return;
          }
          if (action === 'generate') {
            localStorage.setItem('menuAction', action);
            window.location.href = 'index.html';
          }
        });
      });
      permissionsToggle?.addEventListener('change', () => {
        const next = permissionsToggle.checked;
        localStorage.setItem('permissionsGranted', next ? 'true' : 'false');
        if (next) {
          localStorage.setItem('permissionsJustGranted', 'true');
        } else {
          localStorage.removeItem('permissionsJustGranted');
          localStorage.removeItem('openDailyOnReturn');
        }
      });
      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') closeMenu();
      });
    })();
  </script>
</body>
</html>
